!function(t){function e(t){for(var e=this;e&&(!e.matches||!e.matches(t));)e=e.parentNode;return e}function n(t){return t.toString()}function o(t){var e=t.getBoundingClientRect(),n=window.getComputedStyle(t);return e.top+t.clientTop+parseInt(n["padding-top"])||0}function i(t,e){var n,i,r=t.getClientRects();if(!r.length)return null;var s=r[r.length-1],a=e.lineHeight,u=t.endContainer.parentElement,c=o(_.getElement(u));return i=t.getBoundingClientRect().bottom,n=i-c<1.5*e.assumedLineHeight?c:a?i-a:s.top,{left:s.left,right:s.right,top:n,bottom:i,height:i-n,width:s.width}}function r(t){return t.rangeCount?i(t.getRangeAt(t.rangeCount-1),s(t)):null}function s(t){var e=_.getElement(t);if(!e)return{background:"highlight"};var n=window.getComputedStyle(e).backgroundColor,o=window.getComputedStyle(e,"::selection"),i=parseInt(o.lineHeight),r=i,s=o.backgroundColor,a=o.color,u=window.navigator.userAgent.match(/Windows/i);return"rgba(0, 0, 0, 0)"!==s&&s!==n||(s=u?"#328efe":"highlight"),isNaN(r)&&(r=1.14*parseInt(o.fontSize)),{lineHeight:i,assumedLineHeight:r,background:s,color:a}}function a(t){var e=document.body,n=document.documentElement,o=document.createElement("div");o.style.paddingLeft=o.style.width="1px",e.appendChild(o);var i=2==o.offsetWidth;e.removeChild(o),o=t.getBoundingClientRect();var r=n.clientTop||e.clientTop||0,s=n.clientLeft||e.clientLeft||0,a=window.pageYOffset||i&&n.scrollTop||e.scrollTop,u=window.pageXOffset||i&&n.scrollLeft||e.scrollLeft;return{top:o.top+a-r,left:o.left+u-s}}function u(t){for(var e=["direction","font-family","font-size","font-size-adjust","font-variant","font-weight","font-style","letter-spacing","line-height","text-align","text-indent","text-transform","word-wrap","word-spacing"],n="white-space:pre;padding:0;margin:0;",o=0;o<e.length;o++){var i=e[o];n+=i+":"+t.getPropertyValue(i)+";"}return n}function c(t,e,n){var o=document.createElement("span");return o.style.cssText=e,o.textContent=n,t.appendChild(o),o}function l(t,e,n,o){if(!(t&&"value"in t))return null;if(e>=n)return null;var i=window.getComputedStyle(t),r=a(t),s=r.top,l=r.left,h=parseFloat(i.width),d=parseFloat(i.height);s+=parseFloat(i["padding-top"]),s+=parseFloat(i["border-top-width"]),l+=parseFloat(i["padding-left"]),l+=parseFloat(i["border-left-width"]),l+=1;var p=u(i),_=t.value,f=_.length,g=document.createElement("div");e>0&&c(g,p,_.substring(0,e));var m=c(g,p,_.substring(e,n));f>n&&c(g,p,_.substring(n,f)),g.style.cssText=p,g.style.position="absolute",g.style.top=s+"px",g.style.left=l+"px",g.style.width=h+"px",g.style.height=d+"px",document.body.appendChild(g);var w=m.getBoundingClientRect();return w={bottom:w.bottom,top:w.top,height:w.height,left:w.left,right:w.right,width:w.width},w.left-=t.scrollLeft,w.right-=t.scrollLeft,w.bottom-=t.scrollTop,w.top-=t.scrollTop,o||g.parentNode.removeChild(g),w}function h(t){if("true"===t.contentEditable)return!0;for(;t=t.parentNode;)if("true"===t.contentEditable)return!0;return!1}function d(){function t(t){_.getNearest(t.target,".corom-element")?t.stopPropagation():chrome.runtime.sendMessage({type:"close_popups"})}function e(t){i&&i.text!==r&&(chrome.runtime.sendMessage({type:"report_small_count",name:"PopupOpened",value:t}),r=i.text)}function n(){if(!document.head&&!document.body)return setTimeout(n);document.querySelector('link[rel="stylesheet"], style')||(document.head||document.body).appendChild(document.createElement("style"))}var o=new w;o.load();var i=null,r=null,s=null,a={POPUP_OPENED_SELECTION:0,POPUP_OPENED_DOUBLECLICK:1,POPUP_OPENED_CONTEXTMENU:2};selection.onSelect.addListener(function(t){s={text:t.text,coords:t.coords,style:t.style};var e=!t.coords||!o.isTranslateEnabled(t.source),n={text:t.text,notify:e},r=new f;chrome.runtime.sendMessage({type:"on_selection",data:n},function(t){r[t.error?"reject":"resolve"](t)}),r.success(function(e){popup.show({text:e.translation,coords:t.coords,style:t.style,expand:!1})}),i={text:t.text,request:r,source:t.source}}),selection.onDeselect.addListener(function(t){t&&chrome.runtime.sendMessage({type:"disable_menu"}),null!==i&&(i.request.reject(),i=null),t||window.popup.hide()}),popup.onPopupShow.addListener(e.bind(this,a.POPUP_OPENED_SELECTION)),document.addEventListener("dblclick",setTimeout.bind(this,function(){if(i){if(!o.isDoubleClickTranslateEnabled(i.source))return;i.request.success(function(){e(a.POPUP_OPENED_DOUBLECLICK),popup.expanded=!0})}}),!1),window.addEventListener("resize",t,!1),document.addEventListener("contextmenu",t,!1),chrome.runtime.onMessage.addListener(function(t,n,o){if("on_context_menu"===t.type){if(!t.data)return;var i=t.data.translation;if(!i)return;var r=null,u=null;if(s&&s.text===t.data.originalText?(r=s.coords,u=s.style):(s=null,r=selection.getCoords(),u=selection.getStyle()),null===r)return;e(a.POPUP_OPENED_CONTEXTMENU),popup.show({text:i,coords:r,style:u,expand:!0})}"close_popup"===t.type&&popup.hide()}),n()}var p;!function(t){"undefined"!=typeof module&&module.exports?module.exports=t:"function"==typeof define?define(t):p=t}(function(){function t(t,e){return RegExp.prototype.test.call(t,e)}function e(e){return!t(_,e)}function n(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(t){this.string=t,this.tail=t,this.pos=0}function i(t,e){this.view=t,this.parent=e,this.clearCache()}function r(){this.clearCache()}function s(t){for(var e,n=t[3],o=n;(e=t[4])&&e.length;)o=(t=e[e.length-1])[3];return[n,o]}function a(t){function e(t,e,o){if(!n[t]){var i=a(e);n[t]=function(t,e){return i(t,e,o)}}return n[t]}var n={};return function(n,o,i){for(var r,a,u="",c=0,l=t.length;c<l;++c)switch((r=t[c])[0]){case"#":a=i.slice.apply(i,s(r)),u+=n._section(r[1],o,a,e(c,r[4],i));break;case"^":u+=n._inverted(r[1],o,e(c,r[4],i));break;case">":u+=n._partial(r[1],o);break;case"&":u+=n._name(r[1],o);break;case"name":u+=n._escaped(r[1],o);break;case"text":u+=r[1]}return u}}function u(t){for(var e,n,o=[],i=o,r=[],s=0;s<t.length;++s)switch((e=t[s])[0]){case"#":case"^":e[4]=[],r.push(e),i.push(e),i=e[4];break;case"/":if(0===r.length)throw new Error("Unopened section: "+e[1]);if((n=r.pop())[1]!==e[1])throw new Error("Unclosed section: "+n[1]);i=r.length>0?r[r.length-1][4]:o;break;default:i.push(e)}if(n=r.pop())throw new Error("Unclosed section: "+n[1]);return o}function c(t){for(var e,n,o=0;o<t.length;++o)e=t[o],n&&"text"===n[0]&&"text"===e[0]?(n[1]+=e[1],n[3]=e[3],t.splice(o--,1)):n=e}function l(t){if(2!==t.length)throw new Error("Invalid tags: "+t.join(" "));return[new RegExp(n(t[0])+"\\s*"),new RegExp("\\s*"+n(t[1]))]}var h={};h.name="mustache.js",h.version="0.7.0",h.tags=["{{","}}"],h.Scanner=o,h.Context=i,h.Writer=r;var d=/\s*/,p=/\s+/,_=/\S/,f=/\s*=/,g=/\s*\}/,m=/#|\^|\/|>|\{|&|=|!/,w=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},v={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};h.escape=function(t){return String(t).replace(/[&<>"'\/]/g,function(t){return v[t]})},o.prototype.eos=function(){return""===this.tail},o.prototype.scan=function(t){var e=this.tail.match(t);return e&&0===e.index?(this.tail=this.tail.substring(e[0].length),this.pos+=e[0].length,e[0]):""},o.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n),this.pos+=n}return e},i.make=function(t){return t instanceof i?t:new i(t)},i.prototype.clearCache=function(){this._cache={}},i.prototype.push=function(t){return new i(t,this)},i.prototype.lookup=function(t){var e=this._cache[t];if(!e){if("."===t)e=this.view;else for(var n=this;n;){if(t.indexOf(".")>0){var o=t.split("."),i=0;for(e=n.view;e&&i<o.length;)e=e[o[i++]]}else e=n.view[t];if(null!=e)break;n=n.parent}this._cache[t]=e}return"function"==typeof e&&(e=e.call(this.view)),e},r.prototype.clearCache=function(){this._cache={},this._partialCache={}},r.prototype.compile=function(t,e){return this._compile(this._cache,t,t,e)},r.prototype.compilePartial=function(t,e,n){return this._compile(this._partialCache,t,e,n)},r.prototype.render=function(t,e,n){return this.compile(t)(e,n)},r.prototype._compile=function(t,e,n,o){if(!t[e]){var r=a(h.parse(n,o)),s=this;t[e]=function(t,e){if(e)if("function"==typeof e)s._loadPartial=e;else for(var o in e)s.compilePartial(o,e[o]);return r(s,i.make(t),n)}}return t[e]},r.prototype._section=function(t,e,n,o){var i=e.lookup(t);switch(typeof i){case"object":if(w(i)){for(var r="",s=0,a=i.length;s<a;++s)r+=o(this,e.push(i[s]));return r}return i?o(this,e.push(i)):"";case"function":var u=this;return i.call(e.view,n,function(t){return u.render(t,e)})||"";default:if(i)return o(this,e)}return""},r.prototype._inverted=function(t,e,n){var o=e.lookup(t);return!o||w(o)&&0===o.length?n(this,e):""},r.prototype._partial=function(t,e){t in this._partialCache||!this._loadPartial||this.compilePartial(t,this._loadPartial(t));var n=this._partialCache[t];return n?n(e):""},r.prototype._name=function(t,e){var n=e.lookup(t);return"function"==typeof n&&(n=n.call(e.view)),null==n?"":String(n)},r.prototype._escaped=function(t,e){return h.escape(this._name(t,e))},h.parse=function(t,i){for(var r,s,a,_,w=l(i=i||h.tags),v=new o(t),y=[],b=[],E=!1,N=!1;!v.eos();){if(r=v.pos,a=v.scanUntil(w[0]))for(var x=0,C=a.length;x<C;++x)e(_=a.charAt(x))?b.push(y.length):N=!0,y.push(["text",_,r,r+1]),r+=1,"\n"===_&&function(){if(E&&!N)for(;b.length;)y.splice(b.pop(),1);else b=[];E=!1,N=!1}();if(r=v.pos,!v.scan(w[0]))break;if(E=!0,s=v.scan(m)||"name",v.scan(d),"="===s)a=v.scanUntil(f),v.scan(f),v.scanUntil(w[1]);else if("{"===s){var S=new RegExp("\\s*"+n("}"+i[1]));a=v.scanUntil(S),v.scan(g),v.scanUntil(w[1]),s="&"}else a=v.scanUntil(w[1]);if(!v.scan(w[1]))throw new Error("Unclosed tag at "+v.pos);y.push([s,a,r,v.pos]),"name"!==s&&"{"!==s&&"&"!==s||(N=!0),"="===s&&(w=l(i=a.split(p)))}return c(y),u(y)};var y=new r;return h.clearCache=function(){return y.clearCache()},h.compile=function(t,e){return y.compile(t,e)},h.compilePartial=function(t,e,n){return y.compilePartial(t,e,n)},h.render=function(t,e,n){return y.render(t,e,n)},h.to_html=function(t,e,n,o){var i=h.render(t,e,n);if("function"!=typeof o)return i;o(i)},h}()),window.Mustache=p;var _={};_.query=function(t){return 0==t.indexOf("#")?document.getElementById(t.substring(1)):null},Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector),_.getNearest=function(t,n){return e.call(t,n)},_.getElement=function(t){for(;t&&1!==t.nodeType;)t=t.parentNode;return t},_.thouShallNotPass=function(t){return t.preventDefault(),t.stopPropagation(),!1},_.noop=function(){},"undefined"==typeof PRODUCTION&&(_.throttle=function(t,e){var n,o=null;return function(){o?n=arguments:(n=arguments,o=setTimeout(function(){return o=null,t.apply(this,n)},e))}},_.html=function(t){var e=document.createElement(t.tag||"keke");if(t.style)for(var n in t.style)e.style[n]=t.style[n];return t.text&&(e.textContent=t.text),e}),window.Utils=_;var f=function(t){if(0===arguments.length)return this._init(),this;if(t instanceof f)return t;var e=new f;return e.resolve(t),e};f.RUNNING=0,f.RESOLVED=1,f.FAILED=2,f.prototype={constructor:f,_init:function(){this._results=[],this._subscribers=[],this.state=f.RUNNING},_notify:function(){var t=this;this._subscribers.forEach(function(e){e.apply(t,t._results)}),this._subscribers=[]},resolve:function(){return this.state=f.RESOLVED,this._results=arguments,this._notify(),this},reject:function(){return this.state=f.FAILED,this._results=arguments,this._notify(),this},subscribe:function(t){this.state!==f.RUNNING?t.apply(this,this._results):this._subscribers.push(t)},done:function(t){return this.subscribe(t),this},success:function(t){var e=this;return this.subscribe(function(){e.state===f.RESOLVED&&t.apply(e,e._results)}),this},fail:function(t){var e=this;return this.subscribe(function(){e.state===f.FAILED&&t.apply(e,e._results)}),this},bind:function(t){return(t=new f(t)).success(this.resolve.bind(this)).fail(this.reject.bind(this)),this}},f.when=function(){var t=[];return t=Array.isArray(arguments[0])?arguments[0]:_.toArray(arguments),new f.When(t)},f.When=function(t){this._doneCallbacks=[],this._successCallbacks=[],this._failCallbacks=[],this._state=f.RUNNING,this._thingsToDo=t.length,this._results=Array(this._thingsToDo),this._init(t)},f.When.prototype={constructor:f.When,_init:function(t){var e=this;t.forEach(function(t,n){(t=new f(t)).subscribe(function(){t.state===f.FAILED&&(e._state=f.FAILED),e._results[n]=_.toArray(arguments),e._thingsToDo--,e._checkIsDone()})}),this._checkIsDone()},_checkIsDone:function(){if(0!==this._thingsToDo)return!1;var t=[];this._results.forEach(function(e){t=t.concat(e)}),this._state===f.FAILED?this._runCallbacks(this._failCallbacks,t):this._runCallbacks(this._successCallbacks,t),this._runCallbacks(this._doneCallbacks,t),this._doneCallbacks=[],this._successCallbacks=[],this._failCallbacks=[]},_runCallbacks:function(t,e){t.forEach(function(t){t.apply(this,e)})},done:function(t){return this._doneCallbacks.push(t),this._checkIsDone(),this},success:function(t){return this._successCallbacks.push(t),this._checkIsDone(),this},fail:function(t){return this._failCallbacks.push(t),this._checkIsDone(),this}},f.chain=function(){function t(e){if(!e.length)return n.resolve.apply(n,o);var i=e.shift();"function"==typeof i?f(i()).done(function(n){o.push(n),t(e)}):(o.push(i),t(e))}var e,n=new f,o=[];return e=Array.isArray(arguments[0])?arguments[0]:_.toArray(arguments),t(e),n},window.Promise=f,Notifier=function(){this._subscribers=[]},Notifier.prototype={constructor:Notifier,addListener:function(t){return"function"==typeof t&&this._subscribers.push(t),this},unsubscribe:function(t){var e=this._subscribers.indexOf(t);return-1!==e&&this._subscribers.splice(e,1),this},trigger:function(){var t=arguments,e=this;return this._subscribers.forEach(function(n){n.apply(e,t)}),this}};window;var g=["text","password","search","tel","url"],m=function(){this._lastSelectionText=this.getText(),this.onSelect=new Notifier,this.onDeselect=new Notifier;var t=this._checkSelection.bind(this);document.addEventListener("mouseup",t,!1),document.addEventListener("contextmenu",t,!1),document.addEventListener("keyup",t,!1),document.addEventListener("select",t,!1)};m.prototype={constructor:m,_checkSelection:function(t){if(_.getNearest(t.target,".corom-element")||"keyup"===t.type&&"input"!==t.target.tagName.toLowerCase()&&"textarea"!==t.target.tagName.toLowerCase()&&!t.target.isContentEditable)return this.onDeselect.trigger(!0),!0;var e=window.getSelection(),o=n(e),i=_.getElement(e.focusNode);if(this._lastSelectionText!==o){if(this.onDeselect.trigger(),""!==o){var a=r(e),u=t.target;if(!a&&("select"===t.type||"contextmenu"===t.type)){var c=t.target,d="text";c&&("TEXTAREA"===c.tagName||"INPUT"===c.tagName&&g.indexOf(c.type)>-1)&&c.selectionStart!=c.selectionEnd&&(a=l(c,c.selectionStart,c.selectionEnd),d="input",u=c)}if("input"!==d&&(d=h(u)?"input":"notInput"),!a)return;this._lastSelectionText=o;var p=s(_.getElement(u)),f=window.getComputedStyle(_.getElement(u)).getPropertyValue("zoom");f=f?parseInt(f):1,a.left*=f,a.right*=f,a.top*=f,a.bottom*=f,a.height*=f,a.width*=f,this.onSelect.trigger({element:t.target,text:o,coords:a,style:p,source:d})}}else i===t.target&&(this._lastSelectionText=null,this.onDeselect.trigger())},getCoords:function(){return r(window.getSelection())},getStyle:function(){return s(window.getSelection())},getText:function(){return n(window.getSelection())}},"undefined"==typeof PRODUCTION&&(m.prototype.__drawRect=function(t,e){var n="rgb("+[192*Math.random()|0,192*Math.random()|0,192*Math.random()|0].join(",")+")";node=_.html({style:{boxSizing:"border-box",border:"1px dotted "+n,zIndex:2147483647,position:"absolute",left:t.left+"px",top:document.body.scrollTop+t.top+"px",height:t.bottom-t.top+"px",width:t.width+"px",fontWeight:"bold",overflow:"hidden",opacity:.6,color:n},text:""+e}),document.body.appendChild(node)},m.prototype.__drawElementBounds=function(t,e){var n=(t=_.getElement(t)).getBoundingClientRect();this.__drawRect(n,e)},m.prototype.__drawSeletionBounds=function(){var t=window.getSelection();if(t.rangeCount){for(var e=s(selection),n=0;n<t.rangeCount;++n){for(var o=(a=t.getRangeAt(n)).getClientRects(),r=0;r<o.length;++r)this.__drawRect(o[r],"r"+n+","+r),this.__drawRect(i(o[r],e),"r"+n+","+r+"c");this.__drawRect(a.getBoundingClientRect(),"b"+n+","),this.__drawElementBounds(a.commonAncestorContainer,"r"+n+"A")}var a=t.getRangeAt(t.rangeCount-1);return i(a,e)}}),window.selection=new m;var w=function(){this._storage=chrome.storage.local,this._options={},this._default={double_click_translate_enabled:!0,input_translate_enabled:!0,double_click_input_translate_enabled:!1};var t=this;chrome.storage.onChanged.addListener(function(e,n){if("local"===n)for(var o in e)t._options[o]=e[o].newValue}),this.isTranslateEnabled=function(e){return"input"!==e||t.get("input_translate_enabled")},this.isDoubleClickTranslateEnabled=function(e){return!!t.isTranslateEnabled(e)&&("input"===e?t.get("double_click_input_translate_enabled"):t.get("double_click_translate_enabled"))}};w.prototype={load:function(){var t=new f,e=this;return this._storage.get(null,function(n){e._options=n,t.resolve(n)}),t},set:function(t,e){var n={};"string"!=typeof t&&"number"!=typeof t||void 0===e||(n[t]=e,this._options[t]=e,this._storage.set(n))},get:function(t){return t in this._options?this._options[t]:this._default[t]}},window.Options=w,Element.prototype.createShadowRoot||(Element.prototype.createShadowRoot=Element.prototype.webkitCreateShadowRoot),function(){var t=function(){this._coords={top:0,left:0,bottom:0,right:0,width:0,height:0},this._isShown=!1,this._isExpanded=!1,this._createNodes(),this.onPopupShow=new Notifier};t.prototype={constructor:t,TRIGGER_INNER_HTML:"",POPUP_INNER_HTML:"{{text}}",HORIZONTAL_GAP:window===window.top?20:0,VERTICAL_GAP:window===window.top?20:0,_createNodes:function(){var t=document.createElement("div");t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.right=0,t.style.height=0,t.style.margin=0,t.style.textAlign="left",t.style.zIndex=1e10,t.style.pointerEvents="none",t.style.border="none",t.classList.add("corom-element"),this._rootNode=t;var e=document.createElement("style");e.innerHTML='@import "'+chrome.extension.getURL("css/style.css")+'";',this._shadowRoot=t.createShadowRoot(),this._shadowRoot.appendChild(e),this._createTriggerNode(),this._createPopupNode(),this.expanded=!1,window.addEventListener("pagehide",this._destroy.bind(this))},_createTriggerNode:function(){var t=document.createElement("div");t.classList.add("corom-trigger"),t.innerHTML=this.TRIGGER_INNER_HTML,t.addEventListener("mouseup",this._toggle.bind(this),!1),this._triggerNode=t},_createPopupNode:function(){var t=document.createElement("div"),e=document.createElement("div");e.classList.add("corom-popup"),t.hidden=!this._isExpanded,t.appendChild(e),t.style.left=0,t.style.right=0,t.style.pointerEvents="none",t.style.position="absolute",t.style.zIndex="10000000000000",this._popupNode=t,this._popupNodeInner=e},_toggle:function(t){return this.expanded=!this.expanded,this.expanded||this.hide(),_.thouShallNotPass(t)},_setText:function(t){this._popupNodeInner.innerHTML=this.POPUP_INNER_HTML.replace("{{text}}",t)},_setStyle:function(t){this._triggerNode.style.height=t.lineHeight,this._triggerNode.style.lineHeight=t.lineHeight,this._triggerNode.style.backgroundColor=t.background},_getActualPopupSize:function(){this._isShown||(this._popupNodeInner.style.left="-1000px",this._triggerNode.style.left="-1000px",this._popupNode.hidden=!1,this._shadowRoot.appendChild(this._popupNode));var t={width:this._popupNodeInner.offsetWidth,height:this._popupNodeInner.offsetHeight};return this._isShown||(this._popupNode.hidden=!this._isExpanded,this.hide()),t},_destroy:function(){null!==this._triggerNode&&(this._triggerNode.remove(),this._popupNode.remove(),this._rootNode.remove(),this._shadowRoot=null,this._triggerNode=null,this._popupNode=null,this._popupNodeInner=null,this._rootNode=null)},get isShown(){return this._isShown},get coords(){return this._coords},set coords(t){var e=document.body.scrollTop,n=window.innerHeight,o=window.innerWidth,i=this._getActualPopupSize();t.top+i.height+this.VERTICAL_GAP>n?this._popupNode.style.top=t.top+e-i.height+"px":this._popupNode.style.top=t.top+t.height+e+"px",this._triggerNode.style.top=t.top+e+"px",this._triggerNode.style.left=t.right+"px",this._triggerNode.style.height=t.height+"px";var r=Math.max(t.left+i.width+this.HORIZONTAL_GAP-o,0);this._popupNodeInner.style.left=Math.max(t.left-r,this.HORIZONTAL_GAP)+"px",this._coords=t},get expanded(){return this._isExpanded},set expanded(t){t!==this._isExpanded&&(this._isExpanded=t,this._triggerNode.classList[t?"add":"remove"]("shown"),this._popupNode.hidden=!t),t&&this.onPopupShow.trigger()},show:function(t){this._setText(t.text),this.coords=t.coords,this._setStyle(t.style),this._isShown||(document.body.appendChild(this._rootNode,document.body),this._shadowRoot.appendChild(this._popupNode),this._shadowRoot.appendChild(this._triggerNode)),this.expanded=Boolean(t.expand),this._isShown=!0},hide:function(){this._isShown&&(this.expanded=!1,this._triggerNode.remove(),this._popupNode.remove(),this._isShown=!1)}},window.popup=new t,document.addEventListener("mousedown",function(t){_.getNearest(t.target,".corom-element")?t.stopPropagation():window.popup.isShown&&window.popup.hide()},!1),d()}(),function(){function t(t,e){chrome.storage.local.set({lastDelay:t,nextShow:e})}function e(t){return"en"===t.substr(0,2).toLowerCase()}function n(t,e){chrome.runtime.sendMessage({type:"report_small_count",name:t,value:e})}if(window===window.top){var o=chrome.i18n.getMessage,i=navigator.language||navigator.userLanguage,r=new f,s=!1,a="othersites",u=[0,864e6,1728e6,-1],c={NOTIBAR_SHOWED:0,NOTIBAR_ENGAGE_CLICKED:1,NOTIBAR_DISSMISS_CLICKED:2};chrome.runtime.sendMessage({type:"get_language"},function(t){t&&t.lang&&r.resolve(t.lang.substr(0,2).toLowerCase())});var l=function(){this._container=null,this._shadowRoot=null,this.isShown=!1,this._lastDelay=u[0],this._init()};l.prototype={constructor:l,_init:function(){this._getDelayInfo(),this.container=document.createElement("div"),this.container.setAttribute("class","coccoc-en2vi-container"),this.shadowRoot=this.container.createShadowRoot()||this.container.webkitCreateShadowRoot(),this.shadowRoot.innerHTML=this._renderHTML(),this.shadowRoot.querySelector(".btn-show").onclick=this._handleEngage.bind(this),this.shadowRoot.querySelector(".btn-hide").onclick=this._handleDismiss.bind(this);var t=document.createElement("style"),e="";e+='@import "'+chrome.runtime.getURL("css/banner.css")+'";\n',t.innerHTML=e,this.shadowRoot.appendChild(t)},_renderHTML:function(){return p.render('        <div class="banner hide">          <img id="logo" src="{{logo_src}}"/>          <div class="content">            <span>{{i18n_banner_text}}</span>            <div class="btn-group">              <a href="#" class="btn btn-show">{{i18n_show_me_how}}</a>              <a href="#" class="btn btn-hide">{{i18n_i_know_it}}</a>            </div>          </div>        </div>',{logo_src:chrome.runtime.getURL("images/banner-logo.png"),i18n_banner_text:o("banner_text"),i18n_show_me_how:o("show_me_how"),i18n_i_know_it:o("i_know_it"),css_import_url:chrome.runtime.getURL("css/banner.css").toString()})},_getDelayInfo:function(){var t=this;chrome.storage.local.get(["lastDelay","nextShow"],function(e){if(e&&e.lastDelay&&e.nextShow){t._lastDelay=e.lastDelay;var n=e.nextShow;if(t._lastDelay>2)return void(s=!0);Date.now()<n&&(s=!0)}})},_handleEngage:function(o){o.preventDefault(),o.stopPropagation(),t(3,Date.now()-1);var r=e(i)?"http://coccoc.com/en/dictionary#utm_source=":"http://coccoc.com/dictionary#utm_source=";r+=a+"&utm_medium=infobar&utm_campaign=dictionary_education",window.open(r,"_blank"),this._hide(),n("Notibar",c.NOTIBAR_ENGAGE_CLICKED)},_handleDismiss:function(e){e.preventDefault(),e.stopPropagation(),t(this._lastDelay+1,Date.now()+u[this._lastDelay+1]),this._hide(),n("Notibar",c.NOTIBAR_DISSMISS_CLICKED)},_hide:function(){this.shadowRoot.childNodes[1].classList.remove("fly-in"),this.shadowRoot.childNodes[1].classList.add("fly-out"),this.isShown=!1},show:function(){this.shadowRoot.childNodes[1].classList.remove("hide"),this.shadowRoot.childNodes[1].classList.add("fly-in"),this.isShown=!0}},new l;chrome.runtime.sendMessage({type:"is_panel"},function(t){t.isPanel,1})}}(),window.EN_DICTIONARIES=[{utm_source:"google_trans",url_patern:"translate.google.com"},{utm_source:"vdict",url_patern:"vdict.com"},{utm_source:"tratu_vn",url_patern:"tratu.vn"},{utm_source:"tratu_soha",url_patern:"tratu.soha.vn"},{utm_source:"laban",url_patern:"dict.laban.vn"},{utm_source:"tratu_coviet",url_patern:"tratu.coviet.vn"},{utm_source:"vndic",url_patern:"7.vndic.net"},{utm_source:"tracau",url_patern:"tracau.vn"},{utm_source:"1tudien",url_patern:"www.1tudien.com"},{utm_source:"edict",url_patern:"edict.vn"},{utm_source:"babla",url_patern:"www.babla.vn/tieng-anh-tieng-viet"},{utm_source:"tudienabc",url_patern:"www.tudienabc.com"},{utm_source:"informatick",url_patern:"www.informatik.uni-leipzig.de/~duc/Dict"},{utm_source:"hellochao",url_patern:"www.hellochao.vn/tu-dien-tach-ghep-am"},{utm_source:"oxfordict",url_patern:"oxforddictionaries.com"},{utm_source:"dict_cambridge",url_patern:"dictionary.cambridge.org"},{utm_source:"macmillan_dict",url_patern:"www.macmillandictionary.com"},{utm_source:"ozdic",url_patern:"www.ozdic.com"},{utm_source:"yourdict",url_patern:"yourdictionary.com"}],window.EN_COURSES=[{utm_source:"homeclass",url_patern:"homeclass.vn"},{utm_source:"tienganh123",url_patern:"www.tienganh123.com"},{utm_source:"britishcouncil",url_patern:"www.britishcouncil.vn"},{utm_source:"duolingo",url_patern:"vi.duolingo.com"},{utm_source:"elight",url_patern:"elight.edu.vn"},{utm_source:"mshoatoeic",url_patern:"mshoatoeic.com"},{utm_source:"tienganh247",url_patern:"tienganh247.info"},{utm_source:"oxford",url_patern:"oxford.edu.vn"},{utm_source:"ielts_fighter",url_patern:"ielts-fighter.com"},{utm_source:"english4u",url_patern:"english4u.com.vn"},{utm_source:"native.edu",url_patern:"native.edu.vn"},{utm_source:"lopngoaingu",url_patern:"lopngoaingu.com"},{utm_source:"espace",url_patern:"www.e-space.vn"},{utm_source:"apollo360",url_patern:"apollo360.edu.vn"},{utm_source:"native.topica",url_patern:"native.topica.vn"},{utm_source:"smartcom",url_patern:"online.smartcom.vn"},{utm_source:"langmaster",url_patern:"langmaster.edu.vn"},{utm_source:"ngoaingu24h",url_patern:"ngoaingu24h.vn"},{utm_source:"gln.edu",url_patern:"gln.edu.vn"},{utm_source:"247tienganh",url_patern:"247tienganh.com"},{utm_source:"ngocbach",url_patern:"ngocbach.com"}],window.EN_DEFAULT=[{utm_source:"bbc",url_patern:"bbc.com/news"},{utm_source:"cnn",url_patern:"edition.cnn.com"},{utm_source:"dailymail",url_patern:"dailymail.co.uk"},{utm_source:"wikipedia",url_patern:"en.wikipedia.org"},{utm_source:"theguardian",url_patern:"theguardian.com"}]}("undefined"==typeof global?global={}:global);