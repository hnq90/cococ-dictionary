!function(t){function e(t){return t.toString()}function n(t){var e=t.getBoundingClientRect(),n=window.getComputedStyle(t);return e.top+t.clientTop+parseInt(n["padding-top"])||0}function o(t,e){var o,i,r=t.getClientRects();if(!r.length)return null;var l=r[r.length-1],a=e.lineHeight,d=t.endContainer.parentElement,s=n(Utils.getElement(d));return i=t.getBoundingClientRect().bottom,o=i-s<1.5*e.assumedLineHeight?s:a?i-a:l.top,{left:l.left,right:l.right,top:o,bottom:i,height:i-o,width:l.width}}function i(t){return t.rangeCount?o(t.getRangeAt(t.rangeCount-1),r(t)):null}function r(t){var e=Utils.getElement(t);if(!e)return{background:"highlight"};var n=window.getComputedStyle(e).backgroundColor,o=window.getComputedStyle(e,"::selection"),i=parseInt(o.lineHeight),r=i,l=o.backgroundColor,a=o.color,d=window.navigator.userAgent.match(/Windows/i);return"rgba(0, 0, 0, 0)"!==l&&l!==n||(l=d?"#328efe":"highlight"),isNaN(r)&&(r=1.14*parseInt(o.fontSize)),{lineHeight:i,assumedLineHeight:r,background:l,color:a}}function l(t){var e=document.body,n=document.documentElement,o=document.createElement("div");o.style.paddingLeft=o.style.width="1px",e.appendChild(o);var i=2==o.offsetWidth;e.removeChild(o),o=t.getBoundingClientRect();var r=n.clientTop||e.clientTop||0,l=n.clientLeft||e.clientLeft||0,a=window.pageYOffset||i&&n.scrollTop||e.scrollTop,d=window.pageXOffset||i&&n.scrollLeft||e.scrollLeft;return{top:o.top+a-r,left:o.left+d-l}}function a(t){for(var e=["direction","font-family","font-size","font-size-adjust","font-variant","font-weight","font-style","letter-spacing","line-height","text-align","text-indent","text-transform","word-wrap","word-spacing"],n="white-space:pre;padding:0;margin:0;",o=0;o<e.length;o++){var i=e[o];n+=i+":"+t.getPropertyValue(i)+";"}return n}function d(t,e,n){var o=document.createElement("span");return o.style.cssText=e,o.textContent=n,t.appendChild(o),o}function s(t,e,n,o){if(!(t&&"value"in t))return null;if(e>=n)return null;var i=window.getComputedStyle(t),r=l(t),s=r.top,g=r.left,c=parseFloat(i.width),u=parseFloat(i.height);s+=parseFloat(i["padding-top"]),s+=parseFloat(i["border-top-width"]),g+=parseFloat(i["padding-left"]),g+=parseFloat(i["border-left-width"]),g+=1;var p=a(i),h=t.value,f=h.length,m=document.createElement("div");e>0&&d(m,p,h.substring(0,e));var w=d(m,p,h.substring(e,n));f>n&&d(m,p,h.substring(n,f)),m.style.cssText=p,m.style.position="absolute",m.style.top=s+"px",m.style.left=g+"px",m.style.width=c+"px",m.style.height=u+"px",document.body.appendChild(m);var v=w.getBoundingClientRect();return v={bottom:v.bottom,top:v.top,height:v.height,left:v.left,right:v.right,width:v.width},v.left-=t.scrollLeft,v.right-=t.scrollLeft,v.bottom-=t.scrollTop,v.top-=t.scrollTop,o||m.parentNode.removeChild(m),v}function g(t){if("true"===t.contentEditable)return!0;for(;t=t.parentNode;)if("true"===t.contentEditable)return!0;return!1}window;var c=["text","password","search","tel","url"],u=function(){this._lastSelectionText=this.getText(),this.onSelect=new Notifier,this.onDeselect=new Notifier;var t=this._checkSelection.bind(this);document.addEventListener("mouseup",t,!1),document.addEventListener("contextmenu",t,!1),document.addEventListener("keyup",t,!1),document.addEventListener("select",t,!1)};u.prototype={constructor:u,_checkSelection:function(t){if(Utils.getNearest(t.target,".corom-element")||"keyup"===t.type&&"input"!==t.target.tagName.toLowerCase()&&"textarea"!==t.target.tagName.toLowerCase()&&!t.target.isContentEditable)return this.onDeselect.trigger(!0),!0;var n=window.getSelection(),o=e(n),l=Utils.getElement(n.focusNode);if(this._lastSelectionText!==o){if(this.onDeselect.trigger(),""!==o){var a=i(n),d=t.target;if(!a&&("select"===t.type||"contextmenu"===t.type)){var u=t.target,p="text";u&&("TEXTAREA"===u.tagName||"INPUT"===u.tagName&&c.indexOf(u.type)>-1)&&u.selectionStart!=u.selectionEnd&&(a=s(u,u.selectionStart,u.selectionEnd),p="input",d=u)}if("input"!==p&&(p=g(d)?"input":"notInput"),!a)return;this._lastSelectionText=o;var h=r(Utils.getElement(d)),f=window.getComputedStyle(Utils.getElement(d)).getPropertyValue("zoom");f=f?parseInt(f):1,a.left*=f,a.right*=f,a.top*=f,a.bottom*=f,a.height*=f,a.width*=f,this.onSelect.trigger({element:t.target,text:o,coords:a,style:h,source:p})}}else l===t.target&&(this._lastSelectionText=null,this.onDeselect.trigger())},getCoords:function(){return i(window.getSelection())},getStyle:function(){return r(window.getSelection())},getText:function(){return e(window.getSelection())}},"undefined"==typeof PRODUCTION&&(u.prototype.__drawRect=function(t,e){var n="rgb("+[192*Math.random()|0,192*Math.random()|0,192*Math.random()|0].join(",")+")";node=Utils.html({style:{boxSizing:"border-box",border:"1px dotted "+n,zIndex:2147483647,position:"absolute",left:t.left+"px",top:document.body.scrollTop+t.top+"px",height:t.bottom-t.top+"px",width:t.width+"px",fontWeight:"bold",overflow:"hidden",opacity:.6,color:n},text:""+e}),document.body.appendChild(node)},u.prototype.__drawElementBounds=function(t,e){var n=(t=Utils.getElement(t)).getBoundingClientRect();this.__drawRect(n,e)},u.prototype.__drawSeletionBounds=function(){var t=window.getSelection();if(t.rangeCount){for(var e=r(selection),n=0;n<t.rangeCount;++n){for(var i=(a=t.getRangeAt(n)).getClientRects(),l=0;l<i.length;++l)this.__drawRect(i[l],"r"+n+","+l),this.__drawRect(o(i[l],e),"r"+n+","+l+"c");this.__drawRect(a.getBoundingClientRect(),"b"+n+","),this.__drawElementBounds(a.commonAncestorContainer,"r"+n+"A")}var a=t.getRangeAt(t.rangeCount-1);return o(a,e)}}),window.selection=new u}("undefined"==typeof global?global={}:global);