!function(t){Element.prototype.createShadowRoot||(Element.prototype.createShadowRoot=Element.prototype.webkitCreateShadowRoot),function(){var t=function(){this._coords={top:0,left:0,bottom:0,right:0,width:0,height:0},this._isShown=!1,this._isExpanded=!1,this._createNodes(),this.onPopupShow=new Notifier};t.prototype={constructor:t,TRIGGER_INNER_HTML:"",POPUP_INNER_HTML:"{{text}}",HORIZONTAL_GAP:window===window.top?20:0,VERTICAL_GAP:window===window.top?20:0,_createNodes:function(){var t=document.createElement("div");t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.right=0,t.style.height=0,t.style.margin=0,t.style.textAlign="left",t.style.zIndex=1e10,t.style.pointerEvents="none",t.style.border="none",t.classList.add("corom-element"),this._rootNode=t;var e=document.createElement("style");e.innerHTML='@import "'+chrome.extension.getURL("css/style.css")+'";',this._shadowRoot=t.createShadowRoot(),this._shadowRoot.appendChild(e),this._createTriggerNode(),this._createPopupNode(),this.expanded=!1,window.addEventListener("pagehide",this._destroy.bind(this))},_createTriggerNode:function(){var t=document.createElement("div");t.classList.add("corom-trigger"),t.innerHTML=this.TRIGGER_INNER_HTML,t.addEventListener("mouseup",this._toggle.bind(this),!1),this._triggerNode=t},_createPopupNode:function(){var t=document.createElement("div"),e=document.createElement("div");e.classList.add("corom-popup"),t.hidden=!this._isExpanded,t.appendChild(e),t.style.left=0,t.style.right=0,t.style.pointerEvents="none",t.style.position="absolute",t.style.zIndex="10000000000000",this._popupNode=t,this._popupNodeInner=e},_toggle:function(t){return this.expanded=!this.expanded,this.expanded||this.hide(),Utils.thouShallNotPass(t)},_setText:function(t){this._popupNodeInner.innerHTML=this.POPUP_INNER_HTML.replace("{{text}}",t)},_setStyle:function(t){this._triggerNode.style.height=t.lineHeight,this._triggerNode.style.lineHeight=t.lineHeight,this._triggerNode.style.backgroundColor=t.background},_getActualPopupSize:function(){this._isShown||(this._popupNodeInner.style.left="-1000px",this._triggerNode.style.left="-1000px",this._popupNode.hidden=!1,this._shadowRoot.appendChild(this._popupNode));var t={width:this._popupNodeInner.offsetWidth,height:this._popupNodeInner.offsetHeight};return this._isShown||(this._popupNode.hidden=!this._isExpanded,this.hide()),t},_destroy:function(){null!==this._triggerNode&&(this._triggerNode.remove(),this._popupNode.remove(),this._rootNode.remove(),this._shadowRoot=null,this._triggerNode=null,this._popupNode=null,this._popupNodeInner=null,this._rootNode=null)},get isShown(){return this._isShown},get coords(){return this._coords},set coords(t){var e=document.body.scrollTop,o=window.innerHeight,i=window.innerWidth,s=this._getActualPopupSize();t.top+s.height+this.VERTICAL_GAP>o?this._popupNode.style.top=t.top+e-s.height+"px":this._popupNode.style.top=t.top+t.height+e+"px",this._triggerNode.style.top=t.top+e+"px",this._triggerNode.style.left=t.right+"px",this._triggerNode.style.height=t.height+"px";var n=Math.max(t.left+s.width+this.HORIZONTAL_GAP-i,0);this._popupNodeInner.style.left=Math.max(t.left-n,this.HORIZONTAL_GAP)+"px",this._coords=t},get expanded(){return this._isExpanded},set expanded(t){t!==this._isExpanded&&(this._isExpanded=t,this._triggerNode.classList[t?"add":"remove"]("shown"),this._popupNode.hidden=!t),t&&this.onPopupShow.trigger()},show:function(t){this._setText(t.text),this.coords=t.coords,this._setStyle(t.style),this._isShown||(document.body.appendChild(this._rootNode,document.body),this._shadowRoot.appendChild(this._popupNode),this._shadowRoot.appendChild(this._triggerNode)),this.expanded=Boolean(t.expand),this._isShown=!0},hide:function(){this._isShown&&(this.expanded=!1,this._triggerNode.remove(),this._popupNode.remove(),this._isShown=!1)}},window.popup=new t,document.addEventListener("mousedown",function(t){Utils.getNearest(t.target,".corom-element")?t.stopPropagation():window.popup.isShown&&window.popup.hide()},!1),contentScript()}()}("undefined"==typeof global?global={}:global);